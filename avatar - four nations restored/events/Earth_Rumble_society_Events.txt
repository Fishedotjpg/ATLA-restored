#Earth Rumble Events

namespace = ERB

# Hidden start: Send the rank-up request to the current Grandmaster (delayed event on self, from decision to rank up)
character_event = {
	id = ERB.3000

	hide_window = yes

	trigger = {
		has_character_flag = has_sent_request_to_rank_up
	}

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { is_in_society = yes }
			random_society_member = {
				limit = {
					is_society_grandmaster = yes
					same_society_as = ROOT
				}
				character_event = { id = ERB.3001 } # send request to Grand Master. Relic rewards also handled by this event
			}
		}
		if = {
			limit = { is_in_society = no }
			clr_character_flag = has_sent_request_to_rank_up
		}
	}
}

# Grandmaster gets the rank-up request
character_event = {
	id = ERB.3001

	hide_window = yes

	is_triggered_only = yes

	immediate = {
		event_target:rank_up_target = { letter_event = { id = ERB.3002 } }
	}
}

#Grand master approves my request
letter_event = {
	id = ERB.3002
	desc = EVTDESC_MNM_10001_A
	border = GFX_event_letter_frame_intrigue

	trigger = {
		society_rank < 4
		has_character_flag = has_sent_request_to_rank_up
	}

	is_triggered_only = yes

	#Yes
	option = {
		name = {
			text = EVTOPTA_10001
		}
		if = { limit = { society_rank < 4 } #Reminder: Remember you can rankup to 4 in some societies
			society_rank_up = 1
		}
		clr_character_flag = has_sent_request_to_rank_up
	}
}


#From on_character_ask_to_join_society - EARTH RUMBLE
character_event = {
    id = ERB.4450
	hide_window = yes
    is_triggered_only = yes
    trigger = {
    	FROM = { leader = { society_member_of = earth_rumble } }
    }
    immediate = {
    	FROM = { leader = { character_event = { id = ERB.4451 } } }
    }
}

#Ping event
character_event = {
    id = ERB.4451
	hide_window = yes
    is_triggered_only = yes
    immediate = {
    	FROM = { letter_event = { id = ERB.4452 } }
    }
}

#Welcome letter
letter_event = {
    id = ERB.4452
    desc = ERB_JOIN_LETTER
    border = GFX_event_letter_frame_religion
    is_triggered_only = yes

	immediate = {
		set_character_flag = society_join_block
		FROM = { character_event = { id = ERB.4453 } }
	}

    option = {
        name = EVTOPTA_MNM_44511
		join_society = earth_rumble
		clr_character_flag = society_join_block
    }
}

# Bending Training - Giver
character_event = {
	id = ERB.5064
	desc = ERB_TEACH_BENDING_DESC
	is_triggered_only = yes

	option = { # End Training
		name = ERB_TEACH_BENDING_OPT_DESC
	}
}

# Learn bending from a Master - receiver
character_event = {
	id = ERB.5065
	desc = ERB_LEARN_BENDING_DESC
	is_triggered_only = yes

	option = { # End Training
		name = ERB_LEARN_BENDING_OPT_DESC
	}
}

character_event = { # Fired from on_character_leave_society (meant to clear any society related flags and effects)
    id = ERB.2000
    is_triggered_only = yes
	desc = ERB_FORCED_RETIREMENT_DESC
	
	trigger = {
		society_member_of = earth_rumble
		age = 65 
	}
	
	option = {
		name = ERB_FORCED_RETIREMENT_OPT_DESC
		leave_society = yes
	}
}

character_event = { # Fired from on_character_leave_society (meant to clear any society related flags and effects)
    id = ERB.4560
    is_triggered_only = yes
    hide_window = yes
    
    immediate = {
    	clean_up_after_leaving_society_effect = yes #NOTE: update if more societies are added
    }
}

#Quest Events 

### ERB QUESTS
character_event = {
	id = ERB.5000
	hide_window = yes
	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes

	trigger = {
		society_member_of = earth_rumble
		is_society_grandmaster = no
		has_any_quest = no
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_modifier = quest_cooldown_timer }
		society_rank == 1
	}

	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = monastic_leader
		}

		random_list = {
			#10 = { 
			#	modifier = { factor = 0 is_playable = no }
			#	modifier = { factor = 0 age = 16 }
			#	modifier = { factor = 0 trait = powerful_bender }
			#	modifier = { factor = 0 trait = master_bender }
			#	modifier = { factor = 0 trait = legendary_bender }
			#	set_character_flag = erb_quest_learn_bending
			#}
			10 = { 
				modifier = { factor = 0 is_playable = no }
				modifier = {
					factor = 0
					trait = dust_fighter
					trait = crag_climber
					trait = slab_smasher
					trait = facebender
				}
				set_character_flag = erb_quest_pick_gimmick
			}
		}
		event_target:monastic_leader = { character_event = { id = ERB.5001 days = 7 random = 7 } }
	}
}

#Tombola Ping Event
character_event = {
	id = ERB.5001
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				erb_quest_pick_gimmick =	{ clr_character_flag = erb_quest_pick_gimmick society_quest_event = { id = ERB.5002 } }
				erb_quest_learn_bending =	{ clr_character_flag = erb_quest_learn_bending society_quest_event = { id = MNSAK.5076 } }
			}
		}
	}
}

#QUEST: Gimmick Promoter Event 
society_quest_event = {
  id = ERB.5002
  desc = ERB_RANK_1_PROMOTER
  is_triggered_only = yes
  hide_from = yes

  option = {
    name = ACCEPT
    set_quest = quest_erb_gimmick
  }

  option = {
    name = DECLINE
    custom_tooltip = { text = decline_quest_tooltip }

    add_character_modifier = {
      name = quest_cooldown_timer
      hidden = yes
      days = 60
    }

    ai_chance = { factor = 0 }
  }
}

#Earth Rumble Promoter Arrives
character_event = {
	id = ERB.5003
	desc = ERB_RANK_1_TOMBOLA
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = ERB_RANK_1_TOMBOLA_OPT
		hidden_effect = {
			set_variable = { which = earth_rumble_points value = 0 }
			set_character_flag = earth_gimmick_timer
			character_event = { id = ERB.5004 } 
		}
	}
}

character_event = {
	id = ERB.5004
	desc = ERB_RANK_1_TOMBOLA_5004
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		name = ERB_RANK_1_TOMBOLA_OPT_5004
		hidden_effect = {
			if = {
				limit = { age = 16 }
				clr_character_flag = erb_failed_dust_fighter_kid
				clr_character_flag = erb_failed_facebender_kid
			}
			character_event = { id = ERB.5005 days = 1 } 
		}
	}
}

#Tombola & outcome evaluator for earth rumble gimmick
character_event = {
	id = ERB.5005
	hide_window = yes
	is_triggered_only = yes

	trigger = {
			society_member_of = earth_rumble
			has_quest = quest_erb_gimmick
	}

	immediate = {
		if = {
			limit = {
				NOR = {
					society_member_of = earth_rumble
					has_quest = quest_erb_gimmick
				}
			}
			character_event = { id = ERB.4399 }
			break = yes
		}
		if = {
			limit = { 
				has_quest = quest_erb_gimmick
				has_character_flag = earth_gimmick_timer
			}
			random_list = { #Next mission
				30 = { #Dust Fighter
					modifier = { 
						factor = 2
						trait = deceitful
					}
					modifier = { 
						factor = 2
						trait = craven
					}
					modifier = { 
						factor = 2
						trait = paranoid
					}
					modifier = { 
						factor = 2
						trait = cynical
					}
					modifier = { 
						factor = 2
						trait = trickster 
					}
					modifier = { 
						factor = 1.3
						trait = fussy
					}
					modifier = { 
						factor = 1.3
						trait = playful 
					}
					modifier = { 
						factor = 1.3
						trait = curious
					}
					modifier = {
						factor = 0
						has_character_flag = erb_failed_dust_fighter
					}
					character_event = { id = ERB.10000 days = 1 random = 7 }
				}
				30 = { #facebender
					modifier = { 
						factor = 2
						trait = feeble
					}
					modifier = { 
						factor = 2
						trait = sickly
					}
					modifier = { 
						factor = 2
						trait = one_legged
					}
					modifier = { 
						factor = 2
						trait = one_handed
					}
					modifier = { 
						factor = 2
						trait = mangled
					}
					modifier = { 
						factor = 2
						trait = severely_injured
					}
					modifier = { 
						factor = 2
						trait = diligent
					}
					modifier = { 
						factor = 2
						trait = temperate
					}
					modifier = { 
						factor = 2
						trait = is_malnourished
					}
					modifier = { 
						factor = 2
						trait = pregnant
					}
					modifier = {
						factor = 10
						trait = paraplegic
					}
					modifier = {
						factor = 0
						has_character_flag = erb_failed_facebender
					}
					character_event = { id = ERB.11000 days = 1 random = 7 }
				}
			}
		}
	}
}

character_event = {
	id = ERB.10000
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_DUST_FIGHTER_DESC
	
	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}
	
	option = {
		name = ERB_DUST_FIGHTER_OPT_DESC
		character_event = { id = ERB.10001 }
	}
}

#Promoter Training - Dust Fighter 
character_event = {
	id = ERB.10001
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}

	immediate = {
	#Check to see if event is going to come to an end
		if = { 
			limit = {
				OR = {
					check_variable = { which = earth_rumble_points value = 3 }
					NOT = { check_variable = { which = earth_rumble_points value = -2 } }
				}
			}
			# success/fail became dust fighter
			clr_character_flag = erb_pillar_dust
			clr_character_flag = erb_fighting_mickey_dust
			clr_character_flag = erb_dusty_skirmish
			clr_character_flag = erb_locker_room_rubble
			character_event = { id = ERB.10002 } #Mission success/fail
			break = yes
		}
		#run the tombola
		if = {
			limit = { 
				has_quest = quest_erb_gimmick
				has_character_flag = earth_gimmick_timer
			}
			random_list = { 
				5 = {
					character_event = { id = ERB.10010 days = 1 random = 7 }
				}
				10 = {
					modifier = {
						factor = 0
						has_character_flag = erb_pillar_dust
					}
					set_character_flag = erb_pillar_dust
					character_event = { id = ERB.10020 days = 1 random = 7 }
				}
				10 = {
					modifier = {
						factor = 0
						has_character_flag = erb_fighting_mickey_dust
					}
					set_character_flag = erb_fighting_mickey_dust
					narrative_event = { id = ERB.10030 days = 1 random = 7 }
				}
				10 = {
					modifier = {
						factor = 0
						has_character_flag = erb_dusty_skirmish
					}
					modifier = {
						factor = 0.5
						trait = shy
					}
					set_character_flag = erb_dusty_skirmish
					narrative_event = { id = ERB.10040 days = 1 random = 7 }
				}
				10 = {
					modifier = {
						factor = 0
						has_character_flag = erb_locker_room_rubble
					}
					set_character_flag = erb_locker_room_rubble
					character_event = { id = ERB.10050 days = 1 random = 7 }
				}
			}
		}
	}
}

#Dust Fighter Default Event
character_event = {
	id = ERB.10010
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_MICKEY_THROWS_DUST
	
	option = {
		name = ERB_MICKEY_THROWS_DUST_OPT
		character_event = { id = ERB.10011 }
	}
}

character_event = { 
	id = ERB.10011
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_MICKEY_THROWS_DUST_PASS_DESC
	
	option = {
		name = ERB_MICKEY_THROWS_DUST_PASS_OPT
		custom_tooltip = {
			text = ERB_DUST_FIGHTING_PASS_DESC
			hidden_tooltip = {
				change_variable = { which = earth_rumble_points value = 1 }
			}
		 }
		character_event = { id = ERB.10001 }
	}
}

#Dust Fighter Pillar Training
character_event = { 
	id = ERB.10020
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_DESC
	
	option = {
		name = ERB_PILLAR_TRAINING_OPTA
		random_list = {
			90 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10021 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			10 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				character_event = { id = ERB.10022 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_PILLAR_TRAINING_OPTB
		random_list = {
			30 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 5
					trait = gregarious
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10023 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			70 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				modifier = {
					factor = 1.5
					trait = shy
				}
				character_event = { id = ERB.10024 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_PILLAR_TRAINING_OPTC
		random_list = {
			70 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10025 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			30 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				character_event = { id = ERB.10026 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.10021
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_OPTA_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10022
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_OPTA_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10023
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_OPTB_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 3 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10024
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_OPTB_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10025
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_OPTC_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 2 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10026
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_PILLAR_TRAINING_OPTC_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

#Dust Figher Fight Mickey
narrative_event = {
	id = ERB.10030
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_DESC
	
	option = {
		name = ERB_FIGHT_MICKEY_DUST_OPTA
		random_list = {
			70 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10031 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			30 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				character_event = { id = ERB.10032 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_FIGHT_MICKEY_DUST_OPTB
		random_list = {
			60 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10033 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			40 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				character_event = { id = ERB.10034 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_FIGHT_MICKEY_DUST_OPTC
		random_list = {
			50 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10035 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			50 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				character_event = { id = ERB.10036 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.10031
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_OPTA_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10032
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_OPTA_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10033
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_OPTB_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10034
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_OPTB_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10035
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_OPTC_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 2 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10036
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FIGHT_MICKEY_DUST_OPTC_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

#Dust Fighter Dusty Skirmish
narrative_event = {
	id = ERB.10040
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_DESC
	
	option = {
		name = ERB_WARZONE_DUST_CLOUD_OPTA
		random_list = {
			70 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_struggle
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 2
					has_focus = war
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10041 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			30 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					has_focus = carousing
				}
				modifier = {
					factor = 1.5
					has_focus = family
				}
				character_event = { id = ERB.10042 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_WARZONE_DUST_CLOUD_OPTB
		random_list = {
			60 = {
				modifier = {
					factor = 1.5
					trait = deceitful
				}
				modifier = {
					factor = 1.5
					trait = craven
				}
				modifier = {
					factor = 1.5
					trait = cynical
				}
				modifier = {
					factor = 1.5
					trait = trickster
				}
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}
				modifier = {
					factor = 1.5
					trait = flamboyant_schemer
				}
				modifier = {
					factor = 2
					trait = intricate_webweaver
				}
				modifier = {
					factor = 2
					trait = elusive_shadow
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10043 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			40 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				character_event = { id = ERB.10044 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_WARZONE_DUST_CLOUD_OPTC
		random_list = {
			50 = {
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 4
					trait = gregarious
				}
				modifier = {
					factor = 3
					trait = brave
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					has_focus = intrigue
				}
				modifier = {
					factor = 1.5
					has_focus = carousing
				}
				modifier = {
					factor = 1.5
					has_focus = family
				}
				modifier = {
					factor = 2
					trait = just
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10045 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			70 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				modifier = {
					factor = 3
					trait = shy
				}
				character_event = { id = ERB.10046 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.10041
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_OPTA_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10042
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_OPTA_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -2 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10043
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_OPTB_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10044
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_OPTB_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10045
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_OPTC_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 2 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10046
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_WARZONE_DUST_CLOUD_OPTC_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		character_event = { id = ERB.10001 }
	}
}

#Dust fighter Locker Room Rubble
character_event = { 
	id = ERB.10050
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKERROOM_RUBBLE_DESC
	
	option = {
		name = ERB_LOCKERROOM_RUBBLE_OPTA
		random_list = {
			60 = {
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_thrift
				}
				modifier = {
					factor = 1.5
					has_focus = focus_ch_etiquette
				}
				modifier = {
					factor = 2
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10051 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			20 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				character_event = { id = ERB.10052 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_LOCKERROOM_RUBBLE_OPTB
		random_list = {
			60 = {
				modifier = {
					factor = 1.5
					trait = playful
				}
				modifier = {
					factor = 1.5
					trait = fussy
				}
				modifier = {
					factor = 1.5
					trait = curious
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.10053 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_PASS_DESC
				}
			}
			30 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				character_event = { id = ERB.10054 }
				custom_tooltip = {
					text = ERB_DUST_FIGHTING_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.10051
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKERROOM_RUBBLE_OPTA_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
		random_society_member = {
			is_society_grandmaster = no 
			add_rival = PREV
		}
	}
}

character_event = {
	id = ERB.10052
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKERROOM_RUBBLE_OPTA_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10053
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKERROOM_RUBBLE_OPTB_PASS
	
	option = {
		name = ERB_DUST_FIGHTER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.10001 }
	}
}

character_event = {
	id = ERB.10054
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKERROOM_RUBBLE_OPTB_FAIL
	
	option = {
		name = ERB_DUST_FIGHTER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.10001 }
	}
}

#Fail/success evaluation for earth rumble gimmick - dust fighter
character_event = {
	id = ERB.10002
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { FROM = { check_variable = { which = earth_rumble_points value = 3 } } }
			FROM = { letter_event = { id = ERB.10003 } }
		}
		if = {
			limit = { FROM = { NOT = { check_variable = { which = earth_rumble_points value = -2 } } } }
			FROM = { letter_event = { id = ERB.10004 } }
		}
	}
}

# Earth Rumble Gimmick - Dust Fighter success
letter_event = {
	id = ERB.10003
	border = GFX_event_letter_frame_religion
	desc = ERB_SUCCESSFUL_DUST_FIGHTER
	is_triggered_only = yes
	
	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}

	option = {
		name = ERB_DUST_FIGHTER_SUCCESS
		add_trait = dust_fighter
		if = {
			limit = { has_quest = quest_erb_gimmick }
			clr_quest = quest_erb_gimmick
			remove_character_modifier = erb_working_with_promoter
		}
		else = {
			add_society_currency_medium_effect = yes
		}
		hidden_effect = { 
			clr_character_flag = earth_gimmick_timer
		}
	}
}

#Earth Rumble Gimmick - Dust Fighter failure
letter_event = {
	id = ERB.10004
	desc = ERB_DUST_FIGHTER_FAILURE
	is_triggered_only = yes

	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}

	option = {
		name = ERB_DUST_FIGHTER_FAILURE_OPT

		if = {
			limit = { has_quest = quest_erb_gimmick }
			clr_quest = { id = quest_erb_gimmick failure = yes }
			remove_character_modifier = erb_working_with_promoter
		}
		if = {
			limit = { age = 16 }
			set_character_flag = erb_failed_dust_fighter
		}
		if = {
			limit = { NOT = { age = 16 } }
			set_character_flag = erb_failed_dust_fighter_kid
		}
		hidden_effect = {
			clr_character_flag = earth_gimmick_timer
		}
	}
}

character_event = {
	id = ERB.11000
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FACEBENDER_DESC
	
	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}
	
	option = {
		name = ERB_FACEBENDER_OPT_DESC
		character_event = { id = ERB.11001 }
	}
}

#Promoter Training - Facebender
character_event = {
	id = ERB.11001
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}

	immediate = {
	#Check to see if event is going to come to an end
		if = { 
			limit = {
				OR = {
					check_variable = { which = earth_rumble_points value = 3 }
					NOT = { check_variable = { which = earth_rumble_points value = -2 } }
				}
			}
			# success/fail became facebender
			clr_character_flag = erb_cliff_training
			clr_character_flag = erb_locker_room_ambush
			clr_character_flag = erb_escort_mission
			clr_character_flag = erb_spider_flies
			character_event = { id = ERB.11002 } #Mission success/fail
			break = yes
		}
		#run the tombola
		if = {
			limit = { 
				has_quest = quest_erb_gimmick
				has_character_flag = earth_gimmick_timer
			}
			random_list = { 
				5 = {
					modifier = { 
						factor = 0
						trait = one_legged
					}
					modifier = { 
						factor = 0
						trait = one_handed
					}
					modifier = { 
						factor = 0
						trait = mangled
					}
					modifier = { 
						factor = 0
						trait = severely_injured
					}
					modifier = { 
						factor = 0
						trait = clubfooted
					}
					modifier = { 
						factor = 0
						trait = pregnant
					}
					narrative_event = { id = ERB.11010 days = 1 random = 7 }
				}
				5 = {
					modifier = { 
						factor = 1.5
						trait = one_legged
					}
					modifier = { 
						factor = 1.5
						trait = one_handed
					}
					modifier = { 
						factor = 1.5
						trait = mangled
					}
					modifier = { 
						factor = 1.5
						trait = severely_injured
					}
					modifier = { 
						factor = 1.5
						trait = clubfooted
					}
					modifier = { 
						factor = 3
						trait = pregnant
					}
					narrative_event = { id = ERB.11020 days = 1 random = 7 }
				}
				20 = {
					modifier = {
						factor = 0
						has_character_flag = erb_cliff_training
					}
					set_character_flag = erb_cliff_training
					character_event = { id = ERB.11030 days = 1 random = 7 }
				}
				20 = {
					modifier = {
						factor = 0
						has_character_flag = erb_locker_room_ambush
					}
					set_character_flag = erb_locker_room_ambush
					character_event = { id = ERB.11040 days = 1 random = 7 }
				}
				20 = {
					modifier = {
						factor = 0
						has_character_flag = erb_escort_mission
					}
					set_character_flag = erb_escort_mission
					narrative_event = { id = ERB.11050 days = 1 random = 7 }
				}
				#20 = {
				#	modifier = {
				#		factor = 0
				#		has_character_flag = erb_spider_flies
				#	}
				#	set_character_flag = erb_spider_flies
				#	character_event = { id = ERB.11060 days = 1 random = 7 }
				#}
			}
		}
	}
}

#Facebender Default Event
narrative_event = {
	id = ERB.11010
	border = GFX_event_narrative_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_SUSPENDED_FROM_CEILING
	
	option = {
		name = ERB_SUSPENDED_FROM_CEILING_OPT
		character_event = { id = ERB.11011 }
	}
}

character_event = { 
	id = ERB.11011
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_SUSPENDED_FROM_CEILING_PASS_DESC
	
	option = {
		name = ERB_SUSPENDED_FROM_CEILING_PASS_OPT
		custom_tooltip = {
			text = ERB_FACEBENDER_PASS_DESC
			hidden_tooltip = {
				change_variable = { which = earth_rumble_points value = 1 }
			}
		 }
		character_event = { id = ERB.11001 }
	}
}

#Facebender Default Disabled Event
narrative_event = {
	id = ERB.11020
	border = GFX_event_narrative_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FANCY_PARTY_FACEBEND
	
	option = {
		name = ERB_FANCY_PARTY_FACEBEND_OPT
		character_event = { id = ERB.11021 }
	}
}

character_event = { 
	id = ERB.11021
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_FANCY_PARTY_FACEBEND_PASS_DESC
	
	option = {
		name = ERB_FANCY_PARTY_FACEBEND_PASS_OPT
		custom_tooltip = {
			text = ERB_FACEBENDER_PASS_DESC
			hidden_tooltip = {
				change_variable = { which = earth_rumble_points value = 1 }
			}
		 }
		character_event = { id = ERB.11001 }
	}
}

#Facebender Cliff Training
character_event = { 
	id = ERB.11030
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_CLIFF_TRAINING_DESC
	
	option = {
		name = ERB_CLIFF_TRAINING_OPTA
		random_list = {
			40 = {
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.11031 }
				custom_tooltip = {
					text = ERB_FACEBENDER_PASS_DESC
				}
			}
			60 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				character_event = { id = ERB.11032 }
				custom_tooltip = {
					text = ERB_FACEBENDER_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_CLIFF_TRAINING_OPTB
		random_list = {
			30 = {
				modifier = {
					factor = 1.5
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.11033 }
				custom_tooltip = {
					text = ERB_FACEBENDER_PASS_DESC
				}
			}
			70 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				character_event = { id = ERB.11034 }
				custom_tooltip = {
					text = ERB_FACEBENDER_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.11031
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_CLIFF_TRAINING_OPTA_PASS
	
	option = {
		name = ERB_FACEBENDER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11032
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_CLIFF_TRAINING_OPTA_FAIL
	
	option = {
		name = ERB_FACEBENDER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11033
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_CLIFF_TRAINING_OPTB_PASS
	
	option = {
		name = ERB_FACEBENDER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11034
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_CLIFF_TRAINING_OPTB_FAIL
	
	option = {
		name = ERB_FACEBENDER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.11001 }
	}
}

#Facebender Locker Room Ambush
character_event = { 
	id = ERB.11040
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKER_ROOM_AMBUSH_DESC
	
	option = {
		name = ERB_LOCKER_ROOM_AMBUSH_OPTA
		random_list = {
			40 = {
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.11041 }
				custom_tooltip = {
					text = ERB_FACEBENDER_PASS_DESC
				}
			}
			60 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				character_event = { id = ERB.11042 }
				custom_tooltip = {
					text = ERB_FACEBENDER_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_LOCKER_ROOM_AMBUSH_OPTB
		random_list = {
			30 = {
				modifier = {
					factor = 1.5
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.11043 }
				custom_tooltip = {
					text = ERB_FACEBENDER_PASS_DESC
				}
			}
			70 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				character_event = { id = ERB.11044 }
				custom_tooltip = {
					text = ERB_FACEBENDER_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.11041
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKER_ROOM_AMBUSH_OPTA_PASS
	
	option = {
		name = ERB_FACEBENDER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11042
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKER_ROOM_AMBUSH_OPTA_FAIL
	
	option = {
		name = ERB_FACEBENDER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11043
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKER_ROOM_AMBUSH_OPTB_PASS
	
	option = {
		name = ERB_FACEBENDER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11044
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_LOCKER_ROOM_AMBUSH_OPTB_FAIL
	
	option = {
		name = ERB_FACEBENDER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.11001 }
	}
}

#Facebender Escort Mission
character_event = { 
	id = ERB.11050
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_ESCORT_MISSION_DESC
	
	option = {
		name = ERB_ESCORT_MISSION_OPTA
		random_list = {
			40 = {
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.11051 }
				custom_tooltip = {
					text = ERB_FACEBENDER_PASS_DESC
				}
			}
			60 = {
				modifier = {
					factor = 1.5
					trait = incompetent_bender
				}
				modifier = {
					factor = 1.5
					trait = competent_bender
				}
				character_event = { id = ERB.11052 }
				custom_tooltip = {
					text = ERB_FACEBENDER_FAIL_DESC
				}
			}
		}
	}
	option = {
		name = ERB_ESCORT_MISSION_OPTB
		random_list = {
			30 = {
				modifier = {
					factor = 1.5
					trait = powerful_bender
				}
				modifier = {
					factor = 2
					trait = master_bender
				}
				modifier = {
					factor = 3
					trait = legendary_bender
				}
				character_event = { id = ERB.11053 }
				custom_tooltip = {
					text = ERB_FACEBENDER_PASS_DESC
				}
			}
			70 = {
				modifier = {
					factor = 2
					trait = incompetent_bender
				}
				character_event = { id = ERB.11054 }
				custom_tooltip = {
					text = ERB_FACEBENDER_FAIL_DESC
				}
			}
		}
	}
}

character_event = {
	id = ERB.11051
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_ESCORT_MISSION_OPTA_PASS
	
	option = {
		name = ERB_FACEBENDER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11052
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_ESCORT_MISSION_OPTA_FAIL
	
	option = {
		name = ERB_FACEBENDER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11053
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_ESCORT_MISSION_OPTB_PASS
	
	option = {
		name = ERB_FACEBENDER_POS_OPT
		change_variable = { which = earth_rumble_points value = 1 }
		character_event = { id = ERB.11001 }
	}
}

character_event = {
	id = ERB.11054
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	hide_from = yes
	desc = ERB_ESCORT_MISSION_OPTB_FAIL
	
	option = {
		name = ERB_FACEBENDER_NEG_OPT
		change_variable = { which = earth_rumble_points value = -1 }
		character_event = { id = ERB.11001 }
	}
}

#Fail/success evaluation for earth rumble gimmick - facebender
character_event = {
	id = ERB.11002
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { FROM = { check_variable = { which = earth_rumble_points value = 3 } } }
			FROM = { letter_event = { id = ERB.11003 } }
		}
		if = {
			limit = { FROM = { NOT = { check_variable = { which = earth_rumble_points value = -2 } } } }
			FROM = { letter_event = { id = ERB.11004 } }
		}
	}
}

# Earth Rumble Gimmick - Facebender success
letter_event = {
	id = ERB.11003
	border = GFX_event_letter_frame_religion
	desc = ERB_SUCCESSFUL_FACEBENDER
	is_triggered_only = yes
	
	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}

	option = {
		name = ERB_FACEBENDER_SUCCESS
		add_trait = facebender
		if = {
			limit = { has_quest = quest_erb_gimmick }
			clr_quest = quest_erb_gimmick
			remove_character_modifier = erb_working_with_promoter
		}
		else = {
			add_society_currency_medium_effect = yes
		}
		hidden_effect = { 
			clr_character_flag = earth_gimmick_timer
		}
	}
}

#Earth Rumble Gimmick - Facebender failure
letter_event = {
	id = ERB.11004
	desc = ERB_FACEBENDER_FAILURE
	is_triggered_only = yes

	trigger = {
		society_member_of = earth_rumble
		has_quest = quest_erb_gimmick
	}

	option = {
		name = ERB_FACEBENDER_FAILURE_OPT

		if = {
			limit = { has_quest = quest_erb_gimmick }
			clr_quest = { id = quest_erb_gimmick failure = yes }
			remove_character_modifier = erb_working_with_promoter
		}
		if = {
			limit = { age = 16 }
			set_character_flag = erb_failed_facebender
		}
		if = {
			limit = { NOT = { age = 16 } }
			set_character_flag = erb_failed_facebender_kid
		}
		hidden_effect = {
			clr_character_flag = earth_gimmick_timer
		}
	}
}

#Left Monastic Order or cancelled seclusion mission, and therefore rejoins the world of the living
character_event = {
	id = ERB.4399
	border = GFX_event_normal_frame_religion
	desc = EVTDESC_ERB_4399
	picture = GFX_evt_recovery

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			remove_character_modifier = doing_penance
			remove_character_modifier = in_meditation
		}
	}

	option = {
		name = EVTOPTA_ERB_4399

		if = {
			limit = { has_quest = quest_monastic_order_penance }
			clr_quest = { id = quest_monastic_order_penance failure = yes }
		}
		if = {
			limit = { has_quest = quest_monastic_order_meditation }
			clr_quest = { id = quest_monastic_order_meditation failure = yes }
		}
		hidden_effect = {
			hidden_effect = {
				clr_character_flag = success_seculison_desc_A #Flags from 4426
				clr_character_flag = success_seculison_desc_B
				clr_character_flag = success_seculison_desc_C
				clr_character_flag = holy_seclusion_struggled_with_vice
				clr_character_flag = holy_seclusion_scripture_reading
				clr_character_flag = holy_seclusion_timer
				clr_character_flag = holy_seclusion_struggled_with_loneliness
				clr_character_flag = holy_seclusion_interrupting_child
			}
		}
	}
}